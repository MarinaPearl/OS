Задача: доказать, что задача 11 не может быть решена с использованием двух мьютексов без использования других средств синхронизации.
 
Доказательство:
Доказывать будем от противного: предположим, что решить задачу на таком количестве мьютексов возможно, а затем придем к противоречию.
Очевидно, что если задача реашема на n мьютексах, то она решаема и на n+1.
 
1) count mutex = 0;
Очевидно, для того чтобы вывод родительской и дочерней нитей был синхронизирован: сначала родительская нить выводила первую строку, затем дочерняя и т.д., необходимы примитивы синхронизации, так как без них мы не можем гарантировать, что вывод потоков будет чередующимся.
 
2) count mutex = 1;
Чтобы одновременно несколько потоков не могли печатать строки - мы должны защитить этот участок кода каким-либо примитивом синхронизации. В данном случае - это мьютекс. После того как поток, захвативший мьютекс, произведет печать, он должен освободить мьютекс, иначе у другого потока не будет возможности напечатать строку. Но мы не можем гарантировать какой из потоков следующим захватить мьютекс, тем самым не можем гарантировать чередование печати.
 
3) count mutex  = 2;
   1) первый поток захватил мьютекс, второй не захватил никакой.
   2) первый поток захватил оба мьютекса.
   3) каждый поток захватил по мьютексу.
 
Первый поток может напечатать строку, так как он захватил мьютекс, защищающий участок печати строк, затем он обязан освободить мьютекс, иначе другой поток не сможет распечатать строку. Но опять же мы не можем гарантировать, какой из потоков следующим захватить мьютекс, который защищает участок печати строк, поэтому не можем гарантировать последовательную печать.
 
Так как первый поток захватил оба мьютекса, то он может распечатать строку (он захватил мьютекс, который защищает секцию печати), дальше он должен освободить мьютекс для того, чтобы второй поток смог распечатать строку, но мы не можем гарантировать какой из потоков захватит этот мьютекс следующим, следовательно не можем гарантировать чередование печати.
 
Когда у каждого потока есть по мьютексу, поток, который захватил мьютекс, защищающий секцию печати, сможет распечатать строку, затем он обязан освободить мьютекс, чтобы другой поток смог напечать строку, следователньно сводимся к ситуации, когда один поток владеет мьютексом, а второй не захватил никакой. Следовательно не можем гарантировать чередование печати.


Задача: почему неприменимо к семафорам-счетчикам?

Доказательство: одно из главных отличий семафоров от мьютексов - поток который делает sem_wait не обязан делать sem_post на тот же семафор. То есть поток может сделать sem_wait на один семафор, а затем сделать sem_post на другой семафор, тем самым разблокирую другой поток.
 
 
 
 
 
 
 
 
 
 
 
 
 
 

